**For someone who wants to directly implement the project navigate to 04_open_face folder**

Process of facial recognition can be broken down into 3 steps

- Face detection 

  >  Detecting the faces out of the images and  extracting those images

- Generating embeddings( extracting features from Faces)

  >  Converting the detected faces into embeddings( embeddings == features)

- Training Training a model on those embeddings

  > Using an ml model to learn to classify the embeddings



## Face detection

When a Face is to be recognized in a given image, actually the image not only has faces in it, for that matter of fact it not only contain humans, it has lot of other(random) objects in it, so it would be inefficient for us to take the entire image further into the pipeline, so we extract only the faces of the people in it and send it to the next stage



**Let us explore the optimal method**

### Implementation 

Spoiler alert ->Open Face approach is the best (based on two metrics time and accuracy )
Note-: Codes for implementing the script's are present within the respective folders

### 1) Haarcascade- Classic Approach

Theory-: [Video](https://www.youtube.com/watch?v=F5rysk51txQ&t=408s)

### 2) Hog + SVM implantation-:HOG

Theory-: [Post](https://www.learnopencv.com/histogram-of-oriented-gradients/)

### 3) Using CNN face detect model in open dlib

[Post](https://www.pyimagesearch.com/2017/04/03/facial-landmarks-dlib-opencv-python/)

### 4) Using  model trained on tensorflow architecture and implementing it in opencv

### 5) Using resent

Source-: [Post](https://www.pyimagesearch.com/2018/02/26/face-detection-with-opencv-and-deep-learning/)

### Note:

Using resent was the best approach based on the time taken and accuracy (here accuracy would be, If you slightly tilt your head towards any direction haarcascade would not identify it after a point, but resent is able to do that)

## Face embeddings and recognition:

### 1) LBPH:

Though LBPH is not the best method to produce embeddings for accurate facial recognition, since it also one of the ways which i have tried i am mentioning it.

Theory-: [Post](https://www.learnopencv.com/histogram-of-oriented-gradients/)

### 2) Open face:

 We will be producing embeddings(features) out of the images which we consider is the better representation of the face (with a pretrained network, which is especially trained to do this) so that we can train the model to further predict the faces

Source-:
[Post](https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/)

## Note

Initially I decided to train a standard CNN model on faces ( as we would do for object detection), It was a disaster as ( you might have guessed) because (obviously) distinct objects have features which are easily distinguishable compared to distinct faces(ie: A cat and a dog have things in common than faces of two different human beings) , which makes it difficult for the model to mathematically encapsulate the relationship between the labels and  their features and differentiate between different faces , so this means we need better set of features( which convolution layers generate) for the model(fully connected network) to train , rather than features generated by a Regular CNN, so that is why we use a pretrained network which is specially designed to give us embeddings of the face,
I tried to code it myself, due to performance issues I ended up taking the help of Adrian's post

### Training the model

I have used SVM to train the model on the embeddings generated with open face implementation

### Face recognition summary:

Trying different methods(learning many implementations) I ended up with using implementation from
[Post](https://www.pyimagesearch.com/2018/09/24/opencv-face-recognition/)
You can go to final face recognition folder in the repo to implement it (by training it to your face and testing it out)

### API:

I have wrapped this model as an API, so that we can serve it on different platforms you can check that out [here](https://github.com/sai-krishna-msk/FaceRecognition-API)
